/* Dark theme fixes */
body.dark-theme {
    background-color: #212529 !important;
    color: #f8f9fa !important;
}

body.dark-theme .card {
    background-color: #343a40 !important;
    color: #f8f9fa !important;
}

/* User profile page fixes */
body.dark-theme .navbar {
    background-color: #343a40 !important;
    border-bottom: 1px solid #495057 !important;
}

body.dark-theme .navbar-light .navbar-brand,
body.dark-theme .navbar-light .navbar-nav .nav-link {
    color: #f8f9fa !important;
}

body.dark-theme .dropdown-menu {
    background-color: #343a40 !important;
    border-color: #495057 !important;
}

body.dark-theme .dropdown-item {
    color: #f8f9fa !important;
}

body.dark-theme .dropdown-item:hover, 
body.dark-theme .dropdown-item:focus {
    background-color: #495057 !important;
}

body.dark-theme .dropdown-divider {
    border-top-color: #495057 !important;
}

body.dark-theme .dropdown-header {
    color: #adb5bd !important;
}

/* Profile Card Styling for both themes */
.card-header {
    border-bottom: 1px solid rgba(0, 0, 0, 0.125);
}

body.dark-theme .card-header {
    border-bottom-color: #495057 !important;
}

.card-footer {
    border-top: 1px solid rgba(0, 0, 0, 0.125);
}

body.dark-theme .card-footer {
    border-top-color: #495057 !important;
    background-color: #2c3136 !important;
}

/* Alert styling for both themes */
body.dark-theme .alert-info {
    background-color: #17465c !important;
    border-color: #0f5c7a !important;
    color: #9fcdff !important;
}

/* Force text color for all note cards regardless of background color */
.note-card {
    color: #000000 !important; /* Black text for all note cards by default */
}

/* Override for dark theme */
body.dark-theme .note-card {
    /* Use a border to make notes stand out in dark mode */
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
}

/* Force light text on specific dark-colored notes */
.note-card[style*="background-color: #212529"],
.note-card[style*="background-color: #343a40"],
.note-card[style*="background-color: #495057"],
.note-card[style*="background-color: #000"],
.note-card[style*="background-color: #111"],
.note-card[style*="background-color: #222"],
.note-card[style*="background-color: #333"],
.note-card[style*="background-color: #444"],
.note-card[style*="background-color: #555"] {
    color: #ffffff !important; /* White text for dark background cards */
}

/* Fix date footer text in dark mode */
.card-footer.note-date-footer {
    color: inherit !important; /* Inherit text color from parent */
}

body.dark-theme .card-footer.note-date-footer {
    color: #f8f9fa !important; /* White text in dark mode */
}

/* List view specific styles */
.list-group-item.note-card {
    background-color: inherit !important;
    border-color: rgba(0, 0, 0, 0.125) !important;
    margin-bottom: 0.5rem !important;
}

body.dark-theme .list-group-item.note-card {
    border-color: rgba(255, 255, 255, 0.2) !important;
}

/* Specific override for Grid View in dark mode */
body.dark-theme #grid-view .card.note-card {
    background-color: inherit !important; /* Use the background color from style attribute */
    color: #f8f9fa !important; /* Default to light text in dark mode */
    border-color: rgba(255, 255, 255, 0.2) !important;
}

/* Allow inline background colors to show through */
body.dark-theme #grid-view .card.note-card[style*="background-color:"] {
    background-color: inherit !important; /* This allows the inline style to take effect */
}

/* Only very light colored notes should have dark text in dark mode */
body.dark-theme #grid-view .card.note-card[style*="background-color: #ffffff"],
body.dark-theme #grid-view .card.note-card[style*="background-color: #fff"],
body.dark-theme #grid-view .card.note-card[style*="background-color: #f8f9fa"],
body.dark-theme #grid-view .card.note-card[style*="background-color: #e9ecef"],
body.dark-theme #grid-view .card.note-card[style*="background-color: #dee2e6"],
body.dark-theme #grid-view .card.note-card[style*="background-color: #f0f0f0"],
body.dark-theme #grid-view .card.note-card[style*="background-color: #eee"] {
    color: #000000 !important;
}

/* Override any inline color styles to ensure readability */
body.dark-theme #grid-view .card.note-card:not([style*="background-color: #ffffff"]):not([style*="background-color: #fff"]):not([style*="background-color: #f8f9fa"]):not([style*="background-color: #e9ecef"]):not([style*="background-color: #dee2e6"]):not([style*="background-color: #f0f0f0"]):not([style*="background-color: #eee"]) {
    color: #f8f9fa !important;
}

/* Force all card content to use parent card's color setting */
body.dark-theme #grid-view .card-body .card-title,
body.dark-theme #grid-view .card-body .card-text {
    color: inherit !important;
}

/* JavaScript fix for Grid View in dark mode */
@media (prefers-color-scheme: dark) {
    .dark-theme #grid-view .note-card {
        color: #f8f9fa !important;
    }
}

/* Add !important to all color rules to overcome any specificity issues */
body.dark-theme #grid-view .card.note-card[style*="color:"] {
    color: #f8f9fa !important;
}

/* Style for cards with white background in dark mode */
body.dark-theme #grid-view .card.note-card[style*="background-color: #ffffff"],
body.dark-theme #grid-view .card.note-card[style*="background-color: #fff"] {
    color: #000000 !important;
}

/* Fix for view buttons styles */
.btn-group > .btn {
    margin-right: 2px;
}

/* Ensuring buttons are clearly visible */
.btn-info {
    background-color: #17a2b8 !important;
    color: white !important;
}

.btn-warning {
    background-color: #ffc107 !important;
    color: black !important;
}

.btn-danger {
    background-color: #dc3545 !important;
    color: white !important;
}

/* User profile styling for light/dark theme compatibility */
.card {
    background-color: #ffffff;
    color: #212529;
}

.table {
    color: #212529;
}

.table-striped tbody tr:nth-of-type(odd) {
    background-color: rgba(0, 0, 0, 0.05);
}

body.dark-theme .table {
    color: #f8f9fa;
}

body.dark-theme .table-striped tbody tr:nth-of-type(odd) {
    background-color: rgba(255, 255, 255, 0.05);
}

/* Fix badge colors for both themes */
.badge.bg-success {
    color: #fff !important;
}

.badge.bg-warning {
    color: #212529 !important;
}

body.dark-theme .badge.bg-warning {
    background-color: #ffc107 !important;
}

/* Fix buttons in profile pages */
.btn-outline-primary {
    color: #007bff;
    border-color: #007bff;
}

.btn-outline-primary:hover {
    color: #fff;
    background-color: #007bff;
}

.btn-outline-secondary {
    color: #6c757d;
    border-color: #6c757d;
}

.btn-outline-secondary:hover {
    color: #fff;
    background-color: #6c757d;
}

body.dark-theme .btn-outline-primary {
    color: #8bb9fe;
    border-color: #8bb9fe;
}

body.dark-theme .btn-outline-primary:hover {
    color: #212529;
    background-color: #8bb9fe;
}

body.dark-theme .btn-outline-secondary {
    color: #adb5bd;
    border-color: #adb5bd;
}

body.dark-theme .btn-outline-secondary:hover {
    color: #fff;
    background-color: #6c757d;
}

/* Form controls styling for both themes */
.form-control {
    background-color: #fff;
    color: #212529;
    border: 1px solid #ced4da;
}

.form-control:focus {
    border-color: #86b7fe;
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
}

body.dark-theme .form-control {
    background-color: #2c3034;
    color: #f8f9fa;
    border-color: #495057;
}

body.dark-theme .form-control:focus {
    border-color: #617ca9;
    box-shadow: 0 0 0 0.25rem rgba(52, 87, 160, 0.25);
}

body.dark-theme .form-text.text-muted {
    color: #adb5bd !important;
}

body.dark-theme .col-form-label {
    color: #e9ecef;
}

/* Fix alert styles in both themes */
.alert-success {
    color: #0f5132;
    background-color: #d1e7dd;
    border-color: #badbcc;
}

body.dark-theme .alert-success {
    color: #b1dfbb;
    background-color: #0f3b24;
    border-color: #105c3b;
}

.alert-info {
    color: #055160;
    background-color: #cff4fc;
    border-color: #b6effb;
}

/* Fix navbar in light mode */
.navbar-light {
    background-color: #f8f9fa !important;
}

/* Fix text-muted color in dark mode */
body.dark-theme .text-muted {
    color: #adb5bd !important;
}

/* Make navbar-toggler-icon white in dark mode */
body.dark-theme .navbar-light .navbar-toggler-icon {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(255, 255, 255, 0.75)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e") !important;
}

body.dark-theme .navbar-light .navbar-toggler {
    border-color: rgba(255, 255, 255, 0.5) !important;
    color: #f8f9fa !important;
}

/* Fix placeholder text color in dark mode */
body.dark-theme .form-control::placeholder,
body.dark-theme input::placeholder,
body.dark-theme textarea::placeholder {
    color: rgba(255, 255, 255, 0.6) !important;
}

/* Firefox */
body.dark-theme .form-control::-moz-placeholder,
body.dark-theme input::-moz-placeholder,
body.dark-theme textarea::-moz-placeholder {
    color: rgba(255, 255, 255, 0.6) !important;
    opacity: 1;
}

/* Chrome/Safari/Edge */
body.dark-theme .form-control::-webkit-input-placeholder,
body.dark-theme input::-webkit-input-placeholder,
body.dark-theme textarea::-webkit-input-placeholder {
    color: rgba(255, 255, 255, 0.6) !important;
}

/* Ensure all form-text elements are visible in dark mode */
body.dark-theme .form-text {
    color: rgba(255, 255, 255, 0.9) !important;
}

/* Fix table styling in dark mode */
body.dark-theme .table {
    color: #f8f9fa;
    border-color: #495057;
}

body.dark-theme .table-hover tbody tr:hover {
    background-color: rgba(255, 255, 255, 0.075);
}

body.dark-theme .table-light,
body.dark-theme .table thead.table-light,
body.dark-theme .table-light>td,
body.dark-theme .table-light>th {
    background-color: #343a40 !important;
    color: #f8f9fa !important;
    border-color: #495057 !important;
}

body.dark-theme .table-responsive {
    border-color: #495057;
}

body.dark-theme .table th, 
body.dark-theme .table td {
    border-color: #495057;
}

/* Ensure entire table has dark background */
body.dark-theme .table {
    background-color: #343a40;
}

body.dark-theme tbody {
    background-color: #2c3136;
}

body.dark-theme .table tbody tr {
    background-color: #2c3136;
    color: #f8f9fa;
}

/* Fix small text in tables */
body.dark-theme .text-muted,
body.dark-theme small.text-muted {
    color: #adb5bd !important;
}

/* Fix active items in dropdowns in dark mode */
body.dark-theme .dropdown-item.active, 
body.dark-theme .dropdown-item:active {
    background-color: #0d6efd;
    color: #fff;
}

/* More specific table styles with !important */
body.dark-theme .table-responsive {
    background-color: #212529 !important;
}

body.dark-theme .table,
body.dark-theme .table-hover,
body.dark-theme .table-striped {
    background-color: #2c3136 !important;
    color: #f8f9fa !important;
}

body.dark-theme .table-light, 
body.dark-theme thead.table-light,
body.dark-theme .table > thead.table-light {
    background-color: #343a40 !important;
    color: #f8f9fa !important;
}

body.dark-theme .table > :not(caption) > * > * {
    background-color: #2c3136 !important;
    color: #f8f9fa !important;
    border-bottom-color: #495057 !important;
}

body.dark-theme .table > thead {
    border-bottom-color: #495057 !important;
}

/* Force refresh CSS cache */
body.dark-theme .navbar-toggler-icon {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(255, 255, 255, 0.75)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e") !important;
}

/* Direct targeting for the share table */
body.dark-theme .table-responsive table,
body.dark-theme .table-responsive .table {
    color: white !important;
    background-color: #2c3136 !important;
}

body.dark-theme .table-responsive .table thead,
body.dark-theme .table-responsive .table thead.table-light,
body.dark-theme .table-responsive .table thead.table-light tr,
body.dark-theme .table-responsive .table thead.table-light th {
    background-color: #343a40 !important;
    color: white !important;
    border-color: #495057 !important;
}

body.dark-theme .table-responsive .table tbody tr {
    background-color: #2c3136 !important;
    color: white !important;
}

body.dark-theme .table-responsive .table th,
body.dark-theme .table-responsive .table td {
    border-color: #495057 !important;
    background-color: transparent !important;
}

body.dark-theme .table-hover tbody tr:hover {
    background-color: #3a444e !important;
    color: white !important;
}

/* Fix buttons in tables */
body.dark-theme .btn-outline-secondary {
    color: #ced4da !important;
    border-color: #ced4da !important;
}

body.dark-theme .btn-outline-secondary:hover {
    background-color: #495057 !important;
    color: white !important;
}

/* Fix list view items in dark mode to ensure proper background and text colors */
body.dark-theme #list-view .list-group-item.note-card {
    background-color: #343a40 !important;
    color: #f8f9fa !important;
    border-color: rgba(255, 255, 255, 0.2) !important;
    overflow: hidden;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#list-view .list-group-item.note-card > div:first-child {
    flex: 1;
    min-width: 0; /* Critical for text truncation to work properly */
    max-width: calc(100% - 260px); /* Reserve space for buttons */
}

#list-view .list-group-item.note-card > div:last-child {
    width: auto;
    min-width: 250px;
    text-align: right;
    flex-shrink: 0;
}

#list-view .list-group-item.note-card h5 {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 100%;
}

#list-view .list-group-item.note-card p {
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    max-height: 75px;
}

/* Preserve dark note colors for specific dark backgrounds */
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #212529"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #343a40"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #495057"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #000000"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #111111"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #222222"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #333333"] {
    color: #ffffff !important;
}

/* For non-dark background colors, ensure text is visible */
body.dark-theme #list-view .list-group-item.note-card:not([style*="background-color: #212529"]):not([style*="background-color: #343a40"]):not([style*="background-color: #495057"]):not([style*="background-color: #000000"]):not([style*="background-color: #111111"]):not([style*="background-color: #222222"]):not([style*="background-color: #333333"]) {
    color: #000000 !important;
}

/* Specific override for inline style colors */
body.dark-theme #list-view .list-group-item.note-card[style*="color: #000000"] {
    color: #000000 !important;
}

body.dark-theme #list-view .list-group-item.note-card[style*="color: #ffffff"] {
    color: #ffffff !important;
}

/* DARK MODE LIST VIEW FIX - v2.0 - CACHE BUSTER */
body.dark-theme #list-view .list-group-item,
body.dark-theme #list-view .list-group-item.list-group-item-action,
body.dark-theme #list-view .list-group-item.note-card {
    background-color: #343a40 !important;
    color: #f8f9fa !important;
    border-color: rgba(255, 255, 255, 0.2) !important;
}

/* Color-specific overrides with highest specificity */
body.dark-theme #list-view .list-group .list-group-item.note-card[style*="background-color:"] {
    background-color: inherit !important;
}

body.dark-theme #list-view .list-group .list-group-item.note-card[style*="color:"] {
    color: inherit !important;
}

/* Ensure light notes have dark text, regardless of theme */
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #ffffff"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #f8f9fa"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #e9ecef"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #dee2e6"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #ced4da"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #adb5bd"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #fff"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #f0f0f0"],
body.dark-theme #list-view .list-group-item.note-card[style*="background-color: #eee"] {
    color: #000000 !important;
}

/* Default notes (with no custom color) should always have light text in dark mode */
body.dark-theme #grid-view .card.note-card:not([style*="background-color:"]),
body.dark-theme #list-view .list-group-item.note-card:not([style*="background-color:"]) {
    color: #f8f9fa !important;
    background-color: #343a40 !important;
}

/* Ensure card content is visible in dark mode */
body.dark-theme .card-body .card-title,
body.dark-theme .card-body .card-text,
body.dark-theme #grid-view .card-body .card-title,
body.dark-theme #grid-view .card-body .card-text,
body.dark-theme #list-view .list-group-item .note-title,
body.dark-theme #list-view .list-group-item .note-content {
    color: inherit !important;
}

/* Notification dropdown styling */
.notification-dropdown {
    width: 350px;
    max-height: 500px;
    overflow-y: auto;
    padding: 0;
}

.notification-item {
    padding: 12px 15px;
    white-space: normal;
    cursor: default;
}

.notification-item:hover {
    background-color: #f8f9fa;
}

.notification-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    font-size: 16px;
}

.dark-theme .notification-item:hover {
    background-color: #343a40;
}

.dark-theme .notification-dropdown {
    background-color: #2d3748;
    border-color: #4a5568;
}

.dark-theme .notification-dropdown .dropdown-header,
.dark-theme .notification-dropdown .dropdown-item,
.dark-theme .notification-dropdown .text-muted {
    color: #f8f9fa !important;
}

.dark-theme .notification-dropdown .dropdown-divider {
    border-color: #4a5568;
}

/* Auth links styling */
.navbar-nav .nav-link.fw-bold {
    color: #007bff !important;
    border-bottom: 2px solid #007bff;
    padding-bottom: calc(0.5rem - 2px);
}

body.dark-theme .navbar-nav .nav-link.fw-bold {
    color: #8bb9fe !important;
    border-bottom: 2px solid #8bb9fe;
}

/* Fix for note content overflow in grid view */
#grid-view .card.note-card .card-body {
    overflow: hidden;
    max-height: 300px;
    display: flex;
    flex-direction: column;
}

#grid-view .card.note-card .card-text {
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 5;
    -webkit-box-orient: vertical;
    max-height: 125px;
}

/* Ensure card title also doesn't overflow */
#grid-view .card.note-card .card-title {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 100%;
}

/* Add better button layout for grid view */
#grid-view .card.note-card .mt-auto {
    margin-top: auto !important;
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
}

#grid-view .card.note-card .mt-auto .btn {
    margin-bottom: 5px;
}

/* Improve button alignment in both views */
.btn-sm {
    padding: 0.25rem 0.5rem;
    font-size: 0.875rem;
    white-space: nowrap;
}

/* Responsive adjustments for smaller screens */
@media (max-width: 767px) {
    #list-view .list-group-item.note-card {
        flex-direction: column;
        align-items: flex-start !important;
    }
    
    #list-view .list-group-item.note-card > div:first-child {
        width: 100%;
        max-width: 100%;
        margin-bottom: 10px;
    }
    
    #list-view .list-group-item.note-card > div:last-child {
        margin-top: 10px;
        width: 100%;
        min-width: 100%;
        display: flex;
        flex-wrap: wrap;
        gap: 5px;
        justify-content: flex-start;
    }
    
    #list-view .list-group-item.note-card .btn {
        margin-bottom: 5px;
    }
}

/* Fix for note view page */
.note-card .card-header {
    flex-wrap: wrap;
    gap: 8px;
}

.note-card .card-header .d-flex {
    flex-wrap: wrap;
    gap: 8px;
}

.note-card .card-header .btn {
    margin: 2px;
    white-space: nowrap;
}

/* Ensure button container has proper spacing */
.note-card .card-header > div:last-child {
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
}

/* Improve responsive layout for note view page */
@media (max-width: 767px) {
    .note-card .card-header {
        flex-direction: column;
        align-items: flex-start !important;
    }
    
    .note-card .card-header > div:last-child {
        margin-top: 10px;
        width: 100%;
    }
    
    .note-card .card-header .btn {
        margin-bottom: 5px;
    }
} 